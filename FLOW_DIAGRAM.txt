╔════════════════════════════════════════════════════════════════════════════════╗
║                                                                                ║
║                    📊 ДИАГРАММА ПОТОКА ОБРАБОТКИ ФАЙЛОВ                       ║
║                                                                                ║
║                    Переименование → Выбор → Обработка → Архив                ║
║                                                                                ║
╚════════════════════════════════════════════════════════════════════════════════╝


🎬 ПОЛНЫЙ ПОТОК
═══════════════════════════════════════════════════════════════════════════════

                              ЭТАП 1: ПЕРЕИМЕНОВАНИЕ
                              ═══════════════════════════════════════════════════

                                    watch_folder
                                    (JustRecorded)
                                         │
                                         │ Видео появляется
                                         ↓
                                  ┌──────────────┐
                                  │ Video_*.mp4  │
                                  └──────────────┘
                                         │
                                         │ Приложение ищет встречу
                                         │ в Google Calendar
                                         ↓
                                  ┌──────────────────────────────┐
                                  │ Найдена встреча:             │
                                  │ "Front - Aorta weekly sync"  │
                                  └──────────────────────────────┘
                                         │
                                         │ Переименование
                                         ↓
                                  ┌──────────────────────────────┐
                                  │ Front - Aorta weekly sync    │
                                  │ _2026-01-27_14-30-00.mp4     │
                                  └──────────────────────────────┘
                                         │
                                         │ Файл остается в watch_folder
                                         │ ⚠️ Пользователь должен переносить!
                                         ↓
                                    watch_folder
                                    (JustRecorded)
                                    [ОЖИДАНИЕ]


                              ЭТАП 2: ВЫБОР И ЗАГРУЗКА
                              ═══════════════════════════════════════════════════

                                    watch_folder
                                    (JustRecorded)
                                         │
                                         │ Пользователь переносит файл
                                         ↓
                                  ┌──────────────────────────────┐
                                  │ Front - Aorta weekly sync    │
                                  │ _2026-01-27_14-30-00.mp4     │
                                  └──────────────────────────────┘
                                         │
                                         │ Файл перемещается
                                         ↓
                                  to_transcribe_folder
                                  (ToTranscribe)
                                         │
                                         │ Приложение обнаруживает файл
                                         │ on_video_for_transcription()
                                         ↓
                                  ┌──────────────────────────────┐
                                  │ Загрузка на сервер           │
                                  │ POST /upload                 │
                                  └──────────────────────────────┘
                                         │
                                         │ Получен job_id
                                         ↓
                                  ┌──────────────────────────────┐
                                  │ job_id: 12345                │
                                  └──────────────────────────────┘
                                         │
                                         │ ✅ ФАЙЛ ПЕРЕМЕЩАЕТСЯ
                                         │    В TRANSCRIBED_FOLDER
                                         ↓
                                  to_transcribe_folder
                                  (ToTranscribe)
                                  [ФАЙЛ УДАЛЕН]


                              ЭТАП 3: ТРАНСКРИБЦИЯ И АРХИВ
                              ═══════════════════════════════════════════════════

                                  transcribed_folder
                                  (Transcribed)
                                         │
                                         │ Файл появляется
                                         ↓
                                  ┌──────────────────────────────┐
                                  │ Front - Aorta weekly sync    │
                                  │ _2026-01-27_14-30-00.mp4     │
                                  └──────────────────────────────┘
                                         │
                                         │ Сервер обрабатывает видео
                                         │ Scriberr API
                                         ↓
                                  ┌──────────────────────────────┐
                                  │ Транскрибция                 │
                                  │ Идентификация спикеров       │
                                  │ Генерация summary            │
                                  └──────────────────────────────┘
                                         │
                                         │ Результаты обрабатываются
                                         ↓
                                  ┌──────────────────────────────┐
                                  │ Публикация в Google Sheets   │
                                  │ Сохранение транскрипта       │
                                  │ Загрузка в Google Drive      │
                                  └──────────────────────────────┘
                                         │
                                         │ Архивирование
                                         ↓
                                  transcribed_folder
                                  (Transcribed)
                                  [АРХИВ]


═══════════════════════════════════════════════════════════════════════════════
                              СТРУКТУРА ПАПОК
═══════════════════════════════════════════════════════════════════════════════

D:\Nextcloud\Videos\ScreenRecordings\
│
├─ JustRecorded\                    ← watch_folder (ЭТАП 1)
│  ├─ Video_2026-01-27_14-30-00.mp4
│  ├─ Video_2026-01-27_15-00-00.mp4
│  └─ ...
│
├─ ToTranscribe\                    ← to_transcribe_folder (ЭТАП 2)
│  ├─ Front - Aorta weekly sync_2026-01-27_14-30-00.mp4
│  ├─ Another Meeting_2026-01-27_15-00-00.mp4
│  └─ ...
│
└─ Transcribed\                     ← transcribed_folder (ЭТАП 3)
   ├─ Front - Aorta weekly sync_2026-01-27_14-30-00.mp4
   ├─ Front - Aorta weekly sync_2026-01-27_14-30-00_transcript.txt
   ├─ Another Meeting_2026-01-27_15-00-00.mp4
   ├─ Another Meeting_2026-01-27_15-00-00_transcript.txt
   └─ ...


═══════════════════════════════════════════════════════════════════════════════
                              ВРЕМЕННАЯ ШКАЛА
═══════════════════════════════════════════════════════════════════════════════

Время    │ Событие                              │ Папка
─────────┼──────────────────────────────────────┼──────────────────
14:30:00 │ Видео записано                       │ JustRecorded
14:30:05 │ Файл переименован                    │ JustRecorded
14:30:10 │ Пользователь переносит файл          │ ToTranscribe
14:30:15 │ Приложение обнаруживает файл         │ ToTranscribe
14:30:20 │ Файл загружается на сервер           │ ToTranscribe
14:30:25 │ ✅ Файл перемещается в Transcribed   │ Transcribed
14:30:30 │ Сервер начинает транскрибцию         │ Transcribed
14:35:00 │ Транскрибция завершена               │ Transcribed
14:35:05 │ Результаты опубликованы              │ Transcribed
14:35:10 │ Архивирование завершено              │ Transcribed


═══════════════════════════════════════════════════════════════════════════════
                              КЛЮЧЕВЫЕ МОМЕНТЫ
═══════════════════════════════════════════════════════════════════════════════

✅ АВТОМАТИЧЕСКОЕ:
   ├─ Переименование файла
   ├─ Загрузка на сервер
   ├─ Транскрибция
   ├─ Обработка результатов
   └─ Перемещение в архив

⚠️ ТРЕБУЕТ ДЕЙСТВИЯ:
   └─ Перенос файла из JustRecorded в ToTranscribe

🚫 НЕ ПРОИСХОДИТ:
   ├─ Удаление файлов
   ├─ Копирование файлов
   └─ Автоматическая загрузка без переноса


═══════════════════════════════════════════════════════════════════════════════
                              СОСТОЯНИЯ ФАЙЛА
═══════════════════════════════════════════════════════════════════════════════

СОСТОЯНИЕ 1: Новое видео
  Папка: JustRecorded
  Имя: Video_2026-01-27_14-30-00.mp4
  Статус: Ожидание переименования

СОСТОЯНИЕ 2: Переименованное видео
  Папка: JustRecorded
  Имя: Front - Aorta weekly sync_2026-01-27_14-30-00.mp4
  Статус: Ожидание переноса пользователем

СОСТОЯНИЕ 3: Готовое к обработке
  Папка: ToTranscribe
  Имя: Front - Aorta weekly sync_2026-01-27_14-30-00.mp4
  Статус: Загрузка на сервер

СОСТОЯНИЕ 4: Обрабатывается
  Папка: Transcribed
  Имя: Front - Aorta weekly sync_2026-01-27_14-30-00.mp4
  Статус: Транскрибция и обработка

СОСТОЯНИЕ 5: Архивировано
  Папка: Transcribed
  Имя: Front - Aorta weekly sync_2026-01-27_14-30-00.mp4
  Имя: Front - Aorta weekly sync_2026-01-27_14-30-00_transcript.txt
  Статус: Завершено


═══════════════════════════════════════════════════════════════════════════════
Дата: 27 января 2026
Статус: ✅ Диаграмма актуальна
═══════════════════════════════════════════════════════════════════════════════

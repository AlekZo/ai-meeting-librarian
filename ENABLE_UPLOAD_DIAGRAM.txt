╔════════════════════════════════════════════════════════════════════════════════╗
║                                                                                ║
║              ДИАГРАММА: enable_upload И ДВУХЭТАПНАЯ АРХИТЕКТУРА               ║
║                                                                                ║
║                    Как они работают вместе?                                   ║
║                                                                                ║
╚════════════════════════════════════════════════════════════════════════════════╝


СЦЕНАРИЙ 1: enable_upload: true (С ЗАГРУЗКОЙ)
═══════════════════════════════════════════════════════════════════════════════

    ┌─────────────────────────────────────────────────────────────────┐
    │ ЭТАП 1: watch_folder (ПЕРЕИМЕНОВАНИЕ)                          │
    │ ✅ ВСЕГДА происходит, независимо от enable_upload              │
    └─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
    ┌─────────────────────────────────────────────────────────────────┐
    │ Видео появляется в watch_folder                                │
    │ Video_2026-01-26_20-30-03.mp4                                  │
    └─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
    ┌─────────────────────────────────────────────────────────────────┐
    │ Приложение переименовывает файл                                │
    │ Front - Aorta weekly sync_2026-01-26_20-30-03.mp4              │
    └─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
    ┌─────────────────────────────────────────────────────────────────┐
    │ Файл остается в watch_folder                                   │
    │ ⚠️ ПОЛЬЗОВАТЕЛЬ ДОЛЖЕН ПЕРЕНОСИТЬ В to_transcribe_folder!      │
    └─────────────────────────────────────────────────────────────────┘
                                    │
                    ┌───────────────┴───────────────┐
                    │                               │
                    ▼                               ▼
        ┌─────────────────────┐      ┌──────────────────────┐
        │ Пользователь        │      │ Пользователь        │
        │ переносит файл      │      │ НЕ переносит        │
        │ в to_transcribe_    │      │ (забыл)             │
        │ folder              │      │                     │
        └─────────────────────┘      └──────────────────────┘
                    │                               │
                    ▼                               ▼
    ┌─────────────────────────────────────────────────────────────────┐
    │ ЭТАП 2: to_transcribe_folder (ЗАГРУЗКА)                        │
    │ ✅ ПРОИСХОДИТ, потому что enable_upload: true                  │
    └─────────────────────────────────────────────────────────────────┘
                    │                               │
                    ▼                               ▼
    ┌──────────────────────────┐      ┌──────────────────────────┐
    │ Приложение обнаруживает  │      │ Файл остается в         │
    │ файл в to_transcribe_    │      │ watch_folder            │
    │ folder                   │      │ (не загружается)        │
    │                          │      │                         │
    │ Загружает на сервер      │      │ ❌ Транскрипция НЕ      │
    │ ✅ Транскрипция НАЧИНАЕТСЯ│      │ начинается              │
    └──────────────────────────┘      └──────────────────────────┘
                    │
                    ▼
    ┌─────────────────────────────────────────────────────────────────┐
    │ Приложение обрабатывает результаты                             │
    │ ├─ Идентифицирует спикеров (AI)                               │
    │ ├─ Генерирует summary                                         │
    │ ├─ Загружает в Google Drive                                   │
    │ └─ Добавляет в Google Sheets                                  │
    └─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
    ┌─────────────────────────────────────────────────────────────────┐
    │ output_folder                                                  │
    │ Front - Aorta weekly sync_2026-01-26_20-30-03.mp4              │
    │ (файл перемещается сюда)                                       │
    └─────────────────────────────────────────────────────────────────┘


СЦЕНАРИЙ 2: enable_upload: false (БЕЗ ЗАГРУЗКИ)
═══════════════════════════════════════════════════════════════════════════════

    ┌─────────────────────────────────────────────────────────────────┐
    │ ЭТАП 1: watch_folder (ПЕРЕИМЕНОВАНИЕ)                          │
    │ ✅ ВСЕГДА происходит, независимо от enable_upload              │
    └─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
    ┌─────────────────────────────────────────────────────────────────┐
    │ Видео появляется в watch_folder                                │
    │ Video_2026-01-26_20-30-03.mp4                                  │
    └─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
    ┌─────────────────────────────────────────────────────────────────┐
    │ Приложение переименовывает файл                                │
    │ Front - Aorta weekly sync_2026-01-26_20-30-03.mp4              │
    └─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
    ┌─────────────────────────────────────────────────────────────────┐
    │ Файл остается в watch_folder                                   │
    │ ⚠️ НЕ ПЕРЕНОСИТЕ В to_transcribe_folder!                       │
    │ (это бесполезно, приложение не загружает)                      │
    └─────────────────────────────────────────────────────────────────┘
                                    │
                    ┌───────────────┴───────────────┐
                    │                               │
                    ▼                               ▼
        ┌─────────────────────┐      ┌──────────────────────┐
        │ Пользователь        │      │ Пользователь        │
        │ переносит файл      │      │ НЕ переносит        │
        │ (но это бесполезно) │      │ (правильно)         │
        └─────────────────────┘      └──────────────────────┘
                    │                               │
                    ▼                               ▼
    ┌─────────────────────────────────────────────────────────────────┐
    │ ЭТАП 2: to_transcribe_folder (НЕ ЗАГРУЖАЕТСЯ)                  │
    │ ❌ НЕ ПРОИСХОДИТ, потому что enable_upload: false              │
    └─────────────────────────────────────────────────────────────────┘
                    │                               │
                    ▼                               ▼
    ┌──────────────────────────┐      ┌──────────────────────────┐
    │ Приложение обнаруживает  │      │ Файл остается в         │
    │ файл в to_transcribe_    │      │ watch_folder            │
    │ folder                   │      │ (не переносится)        │
    │                          │      │                         │
    │ ❌ НЕ загружает на сервер│      │ ✅ Правильно            │
    │ ❌ Транскрипция НЕ       │      │ (не нужна загрузка)     │
    │ начинается               │      │                         │
    │                          │      │                         │
    │ Файл просто остается     │      │                         │
    │ в to_transcribe_folder   │      │                         │
    └──────────────────────────┘      └──────────────────────────┘


СРАВНЕНИЕ: enable_upload: true vs false
═══════════════════════════════════════════════════════════════════════════════

┌──────────────────────────────────────────────────────────────────────────────┐
│ enable_upload: true                                                          │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│ watch_folder                                                                 │
│ ├─ Видео появляется                                                         │
│ ├─ Переименовывается ✅                                                     │
│ └─ Остается в папке                                                         │
│                                                                              │
│ to_transcribe_folder                                                         │
│ ├─ Пользователь ПЕРЕНОСИТ файл (ОБЯЗАТЕЛЬНО!)                              │
│ ├─ Приложение ЗАГРУЖАЕТ на сервер ✅                                        │
│ ├─ Ждет завершения транскрипции                                            │
│ └─ Обрабатывает результаты                                                 │
│                                                                              │
│ output_folder                                                                │
│ └─ Файл перемещается сюда ✅                                                │
│                                                                              │
│ Требуется:                                                                   │
│ ✅ Сервер транскрипции (Scriberr)                                           │
│ ✅ API ключ                                                                 │
│ ✅ Пользователь переносит файл                                              │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│ enable_upload: false                                                         │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│ watch_folder                                                                 │
│ ├─ Видео появляется                                                         │
│ ├─ Переименовывается ✅                                                     │
│ └─ Остается в папке                                                         │
│                                                                              │
│ to_transcribe_folder                                                         │
│ ├─ Пользователь НЕ переносит файл (не нужно)                               │
│ ├─ Приложение НЕ загружает на сервер ❌                                     │
│ └─ Ничего не происходит                                                     │
│                                                                              │
│ output_folder                                                                │
│ └─ Файл НЕ перемещается ❌                                                  │
│                                                                              │
│ Требуется:                                                                   │
│ ❌ Сервер транскрипции НЕ требуется                                         │
│ ❌ API ключ НЕ требуется                                                    │
│ ❌ Пользователь НЕ переносит файл                                           │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘


ТАБЛИЦА ИСТИНЫ
═══════════════════════════════════════════════════════════════════════════════

enable_upload │ Переносить │ Что происходит
──────────────┼────────────┼──────────────────────────────────────────────────
true          │ ✅ ДА      │ Переименование + Загрузка + Транскрипция
true          │ ❌ НЕТ     │ Переименование (загрузка не происходит)
false         │ ✅ ДА      │ Переименование (загрузка не происходит)
false         │ ❌ НЕТ     │ Переименование (загрузка не происходит)


ПРАВИЛЬНЫЕ ДЕЙСТВИЯ
═══════════════════════════════════════════════════════════════════════════════

Если enable_upload: true
├─ ✅ ПЕРЕНОСИТЕ файл в to_transcribe_folder
├─ ✅ Приложение загружает видео
├─ ✅ Приложение обрабатывает транскрипцию
└─ ✅ Результаты публикуются

Если enable_upload: false
├─ ❌ НЕ ПЕРЕНОСИТЕ файл в to_transcribe_folder
├─ ❌ Приложение НЕ загружает видео
├─ ❌ Приложение НЕ обрабатывает транскрипцию
└─ ❌ Результаты НЕ публикуются


ОТВЕТЫ НА ВОПРОСЫ
═══════════════════════════════════════════════════════════════════════════════

❓ Если enable_upload: true, то не нужно переносить?
✅ НЕПРАВИЛЬНО! Вам ВСЕГДА нужно переносить в to_transcribe_folder!

❓ Сразу будет запущена транскрипция?
✅ НЕТ! Только после переноса файла в to_transcribe_folder!

❓ Если enable_upload: false, то нужно вручную переносить?
✅ НЕТ! Переносить не нужно, приложение не загружает в любом случае!


═══════════════════════════════════════════════════════════════════════════════
ИТОГОВАЯ ЛОГИКА:

enable_upload контролирует ЧТО ПРОИСХОДИТ (загружается или нет)
Двухэтапная архитектура контролирует КОГДА это происходит (после переноса)

Переименование ВСЕГДА происходит в watch_folder
Загрузка происходит в to_transcribe_folder ТОЛЬКО если enable_upload: true
═══════════════════════════════════════════════════════════════════════════════
